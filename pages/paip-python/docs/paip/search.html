<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>search.py</title>
  <link rel="stylesheet" href="../pycco.css">
</head>
<body>
<div id="background"></div>
<div id='container'>
  
  <div class='section'>
    <div class='docs'><h1>search.py</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      <p>Searching is one of the most useful strategies in AI programming.  AI problems
can often be expressed as state spaces with transitions between states.  For
instance, the General Problem Solver could be considered as a search
problem--given some states, we apply state transitions to explore the state
space until the goal is reached.</p>
<p>For some example applications, see the following programs:</p>
<ul>
<li><a href="examples/search/pathfinding.html">Pathfinding</a></li>
<li><a href="examples/search/gps.html">GPS by searching</a></li>
</ul>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <hr />
<h1>Tree Searches</h1>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      <p>Many problems find convenient expression as search trees of state spaces: each
state has some successor states, and we explore the "tree" of states formed by
linking each state to its successors.  We can explore this state tree by
holding a set of "candidate", or "current", states, and exploring all its
successors until the goal is reached.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <h2>The general case</h2>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <p>Given some initial states, explore a state space until reaching the goal.</p>
<p><code>states</code> should be a list of initial states (which can be anything).
<code>goal_reached</code> should be a predicate, where <code>goal_reached(state)</code> returns
<code>True</code> when <code>state</code> is the goal state.
<code>get_successors</code> should take a state as input and return a list of that
state's successor states.
<code>combine_states</code> should take two lists of states as input--the current
states and a list of new states--and return a combined list of states.</p>
<p>When the goal is reached, the goal state is returned.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">tree_search</span><span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="n">goal_reached</span><span class="p">,</span> <span class="n">get_successors</span><span class="p">,</span> <span class="n">combine_states</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <p>If there are no more states to explore, we have failed.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="ow">not</span> <span class="n">states</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
    
    <span class="k">if</span> <span class="n">goal_reached</span><span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="k">return</span> <span class="n">states</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <p>Get the states that follow the first current state and combine them
with the other current states.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">successors</span> <span class="o">=</span> <span class="n">get_successors</span><span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="nb">next</span> <span class="o">=</span> <span class="n">combine_states</span><span class="p">(</span><span class="n">successors</span><span class="p">,</span> <span class="n">states</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <p>Recursively search from the new list of current states.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">return</span> <span class="n">tree_search</span><span class="p">(</span><span class="nb">next</span><span class="p">,</span> <span class="n">goal_reached</span><span class="p">,</span> <span class="n">get_successors</span><span class="p">,</span> <span class="n">combine_states</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <h2>Depth-first search</h2>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <p>A tree search where the state space is explored depth-first.</p>
<p>That is, all of the successors of a single state are fully explored before
exploring a sibling state.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">dfs</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">goal_reached</span><span class="p">,</span> <span class="n">get_successors</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">combine</span><span class="p">(</span><span class="n">new_states</span><span class="p">,</span> <span class="n">existing_states</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <p>The new states (successors of the first current state) should be
explored next, before the other states, so they are prepended to the
list of current states.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">new_states</span> <span class="o">+</span> <span class="n">existing_states</span>
    <span class="k">return</span> <span class="n">tree_search</span><span class="p">([</span><span class="n">start</span><span class="p">],</span> <span class="n">goal_reached</span><span class="p">,</span> <span class="n">get_successors</span><span class="p">,</span> <span class="n">combine</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      <h2>Breadth-first search</h2>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      <p>A tree search where the state space is explored breadth-first.</p>
<p>That is, after examining a single state, all of its successors should be
examined before any of their successors are explored.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">bfs</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">goal_reached</span><span class="p">,</span> <span class="n">get_successors</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">combine</span><span class="p">(</span><span class="n">new_states</span><span class="p">,</span> <span class="n">existing_states</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      <p>Finish examining all of the sibling states before exploring any of
their successors--add all the new states at the end of the current
state list.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">existing_states</span> <span class="o">+</span> <span class="n">new_states</span>
    <span class="k">return</span> <span class="n">tree_search</span><span class="p">([</span><span class="n">start</span><span class="p">],</span> <span class="n">goal_reached</span><span class="p">,</span> <span class="n">get_successors</span><span class="p">,</span> <span class="n">combine</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      <h2>Best-first search</h2>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      <p>A tree search where the state space is explored in order of "cost".</p>
<p>That is, given a list of current states, the "cheapest" state (according
to the function <code>cost</code>, which takes a state as input and returns a numerical
cost value) is the next one explored.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">best_first_search</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">goal_reached</span><span class="p">,</span> <span class="n">get_successors</span><span class="p">,</span> <span class="n">cost</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">combine</span><span class="p">(</span><span class="n">new_states</span><span class="p">,</span> <span class="n">existing_states</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      <p>Keep the list of current states ordered by cost--the "cheapest" state
should always be at the front of the list.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">new_states</span> <span class="o">+</span> <span class="n">existing_states</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">cost</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tree_search</span><span class="p">([</span><span class="n">start</span><span class="p">],</span> <span class="n">goal_reached</span><span class="p">,</span> <span class="n">get_successors</span><span class="p">,</span> <span class="n">combine</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-21'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-21'>#</a>
      </div>
      <h2>Beam search</h2>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-22'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-22'>#</a>
      </div>
      <p>A tree search where the state space is explored by considering only the next
<code>beam_width</code> cheapest states at any step.</p>
<p>The downside to this approach is that by eliminating candidate states, the
goal state might never be found!</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">beam_search</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">goal_reached</span><span class="p">,</span> <span class="n">get_successors</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="n">beam_width</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-23'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-23'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">combine</span><span class="p">(</span><span class="n">new_states</span><span class="p">,</span> <span class="n">existing_states</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-24'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-24'>#</a>
      </div>
      <p>To combine new and current states, combine and sort them as in
<code>best_first_search</code>, but take only the first <code>beam_width</code> states.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">new_states</span> <span class="o">+</span> <span class="n">existing_states</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">cost</span><span class="p">)[:</span><span class="n">beam_width</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">tree_search</span><span class="p">([</span><span class="n">start</span><span class="p">],</span> <span class="n">goal_reached</span><span class="p">,</span> <span class="n">get_successors</span><span class="p">,</span> <span class="n">combine</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-25'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-25'>#</a>
      </div>
      <h2>Iterative-widening search</h2>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-26'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-26'>#</a>
      </div>
      <p>A tree search that repeatedly applies <code>beam_search</code> with incrementally
increasing beam widths until the goal state is found.  This strategy is more
likely to find the goal state than a plain <code>beam_search</code>, but at the cost of
exploring the state space more than once.</p>
<p><code>width</code> and <code>max</code> are the starting and maximum beam widths, respectively.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">widening_search</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">goal_reached</span><span class="p">,</span> <span class="n">successors</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-27'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-27'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">width</span> <span class="o">&gt;</span> <span class="nb">max</span><span class="p">:</span> <span class="c"># only increment up to max</span>
        <span class="k">return</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-28'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-28'>#</a>
      </div>
      <p><code>beam_search</code> with the starting width and quit if we've reached the goal.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">res</span> <span class="o">=</span> <span class="n">beam_search</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">goal_reached</span><span class="p">,</span> <span class="n">successors</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">res</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-29'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-29'>#</a>
      </div>
      <p>Otherwise, <code>beam_search</code> again with a higher beam width.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">widening_search</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">goal_reached</span><span class="p">,</span> <span class="n">successors</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="n">width</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-30'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-30'>#</a>
      </div>
      <hr />
<h1>Graph searches</h1>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-31'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-31'>#</a>
      </div>
      <p>For some problem domains, the state space is not really a tree--certain states
could form "cycles", where a successor of a current state is a state that has
been previously examined.</p>
<p>The tree search algorithms we've discussed ignore this possibility and treat
every encountered state as distinct.  This could lead to extra work, though,
as we re-explore certain branches.  Graph search takes equivalent states into
account, keeps track of previously discarded states, and only explores states
that haven't already been encountered.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-32'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-32'>#</a>
      </div>
      <h2>The general case</h2>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-33'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-33'>#</a>
      </div>
      <p>Given some initial states, explore a state space until reaching the goal,
taking care not to re-explore previously visited states.</p>
<p><code>states</code>, <code>goal_reached</code>, <code>get_successors</code>, and <code>combine</code> are identical to
those arguments in <code>tree_search</code>.
<code>old_states</code> is a list of previously encountered states--these should not
be re-vistited during the search.</p>
<p>When the goal is reached, the goal state is returned.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">graph_search</span><span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="n">goal_reached</span><span class="p">,</span> <span class="n">get_successors</span><span class="p">,</span> <span class="n">combine</span><span class="p">,</span> <span class="n">old_states</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-34'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-34'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">old_states</span> <span class="o">=</span> <span class="n">old_states</span> <span class="ow">or</span> <span class="p">[]</span> <span class="c"># initialize, if this is the initial call</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-35'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-35'>#</a>
      </div>
      <p>Check for success and failure.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="ow">not</span> <span class="n">states</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="n">goal_reached</span><span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="k">return</span> <span class="n">states</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-36'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-36'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">visited</span><span class="p">(</span><span class="n">state</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-37'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-37'>#</a>
      </div>
      <p>A state is "visited" if it's in the list of current states or has
been encountered previously.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">state</span> <span class="o">==</span> <span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">states</span> <span class="o">+</span> <span class="n">old_states</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-38'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-38'>#</a>
      </div>
      <p>Filter out the "visited" states from the next state's successors.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">new_states</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">get_successors</span><span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">visited</span><span class="p">(</span><span class="n">s</span><span class="p">)]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-39'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-39'>#</a>
      </div>
      <p>Combine the new states with the existing ones and recurse.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">next_states</span> <span class="o">=</span> <span class="n">combine</span><span class="p">(</span><span class="n">new_states</span><span class="p">,</span> <span class="n">states</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="k">return</span> <span class="n">graph_search</span><span class="p">(</span><span class="n">next_states</span><span class="p">,</span> <span class="n">goal_reached</span><span class="p">,</span> <span class="n">get_successors</span><span class="p">,</span>
                        <span class="n">combine</span><span class="p">,</span> <span class="n">old_states</span> <span class="o">+</span> <span class="p">[</span><span class="n">states</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-40'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-40'>#</a>
      </div>
      <h2>Exploration strategies</h2>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-41'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-41'>#</a>
      </div>
      <p>Just as for tree search, we can define special cases of graph search that use
specific exploration strategies: <em>breadth-first search</em> and <em>depth-first
search</em> are nearly identical as their tree-search varieties.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-42'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-42'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">graph_search_bfs</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">goal_reached</span><span class="p">,</span> <span class="n">get_successors</span><span class="p">,</span> <span class="n">old_states</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-43'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-43'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">combine</span><span class="p">(</span><span class="n">new_states</span><span class="p">,</span> <span class="n">existing_states</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">existing_states</span> <span class="o">+</span> <span class="n">new_states</span>
    <span class="k">return</span> <span class="n">graph_search</span><span class="p">([</span><span class="n">start</span><span class="p">],</span> <span class="n">goal_reached</span><span class="p">,</span> <span class="n">get_successors</span><span class="p">,</span> <span class="n">combine</span><span class="p">,</span>
                        <span class="n">old_states</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-44'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-44'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">graph_search_dfs</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">goal_reached</span><span class="p">,</span> <span class="n">get_successors</span><span class="p">,</span> <span class="n">old_states</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-45'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-45'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">combine</span><span class="p">(</span><span class="n">new_states</span><span class="p">,</span> <span class="n">existing_states</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">new_states</span> <span class="o">+</span> <span class="n">existing_states</span>
    <span class="k">return</span> <span class="n">graph_search</span><span class="p">([</span><span class="n">start</span><span class="p">],</span> <span class="n">goal_reached</span><span class="p">,</span> <span class="n">get_successors</span><span class="p">,</span> <span class="n">combine</span><span class="p">,</span>
                        <span class="n">old_states</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-46'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-46'>#</a>
      </div>
      <hr />
<h1>Application: Pathfinding</h1>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-47'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-47'>#</a>
      </div>
      <p>A common use of searching is in finding the best path between two locations.
This might be useful for planning airline routes or video game character
movements.  We will develop a specialized pathfinding algorithm that uses
graph search on path segments to find the shortest path between two points.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-48'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-48'>#</a>
      </div>
      <h2>Path utilities</h2>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-49'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-49'>#</a>
      </div>
      <p>We first develop some utilities for handling paths and path segments.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-50'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-50'>#</a>
      </div>
      <p><code>Path</code> represents one segment of a path traversing a state space.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">class</span> <span class="nc">Path</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-51'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-51'>#</a>
      </div>
      <p>Create a new path segment by linking <code>state</code> to the branch indicated
by <code>prev_path</code>, where the cost of the path up to (and including) <code>state</code>
is <code>cost</code>.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">prev_path</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">cost</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-52'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-52'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prev_path</span> <span class="o">=</span> <span class="n">prev_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cost</span> <span class="o">=</span> <span class="n">cost</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-53'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-53'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&#39;Path(</span><span class="si">%s</span><span class="s">, </span><span class="si">%s</span><span class="s">, </span><span class="si">%s</span><span class="s">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">prev_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cost</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-54'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-54'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">collect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">states</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">prev_path</span><span class="p">:</span>
            <span class="n">states</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prev_path</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span> <span class="o">+</span> <span class="n">states</span>
        <span class="k">return</span> <span class="n">states</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-55'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-55'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">find_path</span><span class="p">(</span><span class="n">to_state</span><span class="p">,</span> <span class="n">paths</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">to_state</span> <span class="o">==</span> <span class="n">path</span><span class="o">.</span><span class="n">state</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">path</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-56'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-56'>#</a>
      </div>
      <p>When inserting a path into an existing list of paths, we want to keep the
list sorted with respect to some comparison function <code>compare</code>, which
takes two <code>Path</code>s as arguments and returns a number.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">insert_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">paths</span><span class="p">,</span> <span class="n">compare</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-57'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-57'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">compare</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">paths</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">paths</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
            <span class="k">return</span>
    <span class="n">paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-58'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-58'>#</a>
      </div>
      <p>Search the list <code>look_in</code> for a path that ends at the same state as <code>path</code>.
If found, remove that existing path and insert <code>path</code> into the list
<code>replace_in</code>.  Returns True if replacement occurred and False otherwise.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">replace_if_better</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">compare</span><span class="p">,</span> <span class="n">look_in</span><span class="p">,</span> <span class="n">replace_in</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-59'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-59'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">existing</span> <span class="o">=</span> <span class="n">find_path</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">state</span><span class="p">,</span> <span class="n">look_in</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">existing</span> <span class="ow">and</span> <span class="n">compare</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">existing</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">look_in</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">existing</span><span class="p">)</span>
        <span class="n">insert_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">replace_in</span><span class="p">,</span> <span class="n">compare</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-60'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-60'>#</a>
      </div>
      <p>To grow the list of <code>current_paths</code> to include the states in <code>to_states</code>,
we will extend <code>path</code> to each state (assuming the new paths are shorter than
the ones that already exist).</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">extend_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">to_states</span><span class="p">,</span> <span class="n">current_paths</span><span class="p">,</span> <span class="n">old_paths</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="n">compare</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-61'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-61'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">to_states</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-62'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-62'>#</a>
      </div>
      <p>Extend <code>path</code> to each new state, updating the cost by adding the
cost of this extension to the existing path cost.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">extend_cost</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">cost</span> <span class="o">+</span> <span class="n">cost</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">state</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
        <span class="n">extended</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">extend_cost</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-63'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-63'>#</a>
      </div>
      <p>Replace any path in <code>current_paths</code> or <code>old_paths</code> that ends at
<code>state</code> if our new extended path is cheaper.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="n">find_path</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">current_paths</span><span class="p">):</span>
            <span class="n">replace_if_better</span><span class="p">(</span><span class="n">extended</span><span class="p">,</span> <span class="n">compare</span><span class="p">,</span> <span class="n">current_paths</span><span class="p">,</span> <span class="n">current_paths</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">find_path</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">old_paths</span><span class="p">):</span>
            <span class="n">replace_if_better</span><span class="p">(</span><span class="n">extended</span><span class="p">,</span> <span class="n">compare</span><span class="p">,</span> <span class="n">old_paths</span><span class="p">,</span> <span class="n">current_paths</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-64'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-64'>#</a>
      </div>
      <p>If no existing path goes to <code>path</code>, just add our new one to the
end of <code>current_paths</code>.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">insert_path</span><span class="p">(</span><span class="n">extended</span><span class="p">,</span> <span class="n">current_paths</span><span class="p">,</span> <span class="n">compare</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-65'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-65'>#</a>
      </div>
      <h2>A* Search</h2>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-66'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-66'>#</a>
      </div>
      <p>A* is a graph search that finds the shortest-path distance from a start state
to an end state.  It works by incrementally extending paths from the start
state in order of cost and replacing previous paths when shorter ones are
found that reach the same state.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-67'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-67'>#</a>
      </div>
      <p>A heuristic function can be supplied to add additional cost to the cost of
each path; for standard A* search, this function measures the estimated 
distance remaining from the end of a path to the desired goal state.<br />
Supplying the zero function turns this into the well-known Dijkstra's
algorithm.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-68'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-68'>#</a>
      </div>
      <p>Find the shortest path that satisfies <code>goal_reached</code>.  The function
<code>heuristic</code> can be used to specify an ordering strategy among equal-length
paths.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">a_star</span><span class="p">(</span><span class="n">paths</span><span class="p">,</span> <span class="n">goal_reached</span><span class="p">,</span> <span class="n">get_successors</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="n">heuristic</span><span class="p">,</span> <span class="n">old_paths</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-69'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-69'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">old_paths</span> <span class="o">=</span> <span class="n">old_paths</span> <span class="ow">or</span> <span class="p">[]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-70'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-70'>#</a>
      </div>
      <p>First check to see if we're done.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="ow">not</span> <span class="n">paths</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="n">goal_reached</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">state</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">paths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-71'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-71'>#</a>
      </div>
      <p>We will keep the lists of currently-exploring and previously-explored
paths ordered by cost, where the cost of a path is computed as the sum
of the costs of the path segments and the heuristic applied to the final
state in the path.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">compare</span><span class="p">(</span><span class="n">path1</span><span class="p">,</span> <span class="n">path2</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">((</span><span class="n">path1</span><span class="o">.</span><span class="n">cost</span> <span class="o">+</span> <span class="n">heuristic</span><span class="p">(</span><span class="n">path1</span><span class="o">.</span><span class="n">state</span><span class="p">))</span> <span class="o">-</span> 
                <span class="p">(</span><span class="n">path2</span><span class="o">.</span><span class="n">cost</span> <span class="o">+</span> <span class="n">heuristic</span><span class="p">(</span><span class="n">path2</span><span class="o">.</span><span class="n">state</span><span class="p">)))</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-72'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-72'>#</a>
      </div>
      <p>At each step, we extend the shortest path we've encountered so far.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">path</span> <span class="o">=</span> <span class="n">paths</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-73'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-73'>#</a>
      </div>
      <p>We keep track of all previously seen paths in <code>old_paths</code>, so that we can
weed out newly-extended paths that are no better than previously discovered
paths to the same state.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">insert_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">old_paths</span><span class="p">,</span> <span class="n">compare</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-74'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-74'>#</a>
      </div>
      <p>Extend our shortest path to all its possible successor states using
<code>extend_path</code>, which will make sure that <code>paths</code> and <code>old_paths</code> stay
sorted appropriately and weed out redundant paths.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">extend_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">get_successors</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">state</span><span class="p">),</span> <span class="n">paths</span><span class="p">,</span> <span class="n">old_paths</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="n">compare</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-75'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-75'>#</a>
      </div>
      <p>Repeat with the newly-extended paths.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">return</span> <span class="n">a_star</span><span class="p">(</span><span class="n">paths</span><span class="p">,</span> <span class="n">goal_reached</span><span class="p">,</span> <span class="n">get_successors</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="n">heuristic</span><span class="p">,</span> <span class="n">old_paths</span><span class="p">)</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
